function w3tc_popup(c,b,d,a){if(d===undefined){d=800}if(a===undefined){a=600}return window.open(c,b,"width="+d+",height="+a+",status=no,toolbar=no,menubar=no,scrollbars=yes")}function w3tc_input_enable(a,b){jQuery(a).each(function(){var d=jQuery(this);if(b){d.removeAttr("disabled")}else{d.attr("disabled","disabled")}if(b){d.next("[type=hidden]").remove()}else{var c=d.attr("type");if((c!="radio"&&c!="checkbox")||d.is(":checked")){d.after(jQuery("<input />").attr({type:"hidden",name:d.attr("name")}).val(d.val()))}}})}function w3tc_minify_js_file_clear(){if(!jQuery("#js_files :visible").size()){jQuery("#js_files_empty").show()}else{jQuery("#js_files_empty").hide()}}function w3tc_minify_css_file_clear(){if(!jQuery("#css_files :visible").size()){jQuery("#css_files_empty").show()}else{jQuery("#css_files_empty").hide()}}function w3tc_mobile_groups_clear(){if(!jQuery("#mobile_groups li").size()){jQuery("#mobile_groups_empty").show()}else{jQuery("#mobile_groups_empty").hide()}}function w3tc_referrer_groups_clear(){if(!jQuery("#referrer_groups li").size()){jQuery("#referrer_groups_empty").show()}else{jQuery("#referrer_groups_empty").hide()}}function w3tc_minify_js_file_add(g,f,c,e){var b=jQuery('<li><table><tr><th>&nbsp;</th><th>File URI:</th><th>Template:</th><th colspan="3">Embed Location:</th></tr><tr><td>'+(jQuery("#js_files li").size()+1)+'.</td><td><input class="js_enabled" type="text" name="js_files['+g+"]["+f+"]["+c+'][]" value="" size="70" /></td><td><select class="js_file_template js_enabled"></select></td><td><select class="js_file_location js_enabled"><optgroup label="Blocking:"><option value="include">Embed in &lt;head&gt;</option><option value="include-body">Embed after &lt;body&gt;</option><option value="include-footer">Embed before &lt;/body&gt;</option></optgroup><optgroup label="Non-Blocking:"><option value="include-nb">Embed in &lt;head&gt;</option><option value="include-body-nb">Embed after &lt;body&gt;</option><option value="include-footer-nb">Embed before &lt;/body&gt;</option></optgroup></select></td><td><input class="js_file_delete js_enabled button" type="button" value="Delete" /> <input class="js_file_verify js_enabled button" type="button" value="Verify URI" /></td></tr></table></li>');b.find("input:text").val(e);var a=b.find(".js_file_template");for(var d in minify_templates[g]){a.append(jQuery("<option />").val(d).html(minify_templates[g][d]))}a.val(f);jQuery(b).find(".js_file_location").val(c);jQuery("#js_files").append(b).find("li:last input:first").focus();w3tc_minify_js_file_clear()}function w3tc_minify_css_file_add(f,e,d){var b=jQuery('<li><table><tr><th>&nbsp;</th><th>File URI:</th><th colspan="2">Template:</th></tr><tr><td>'+(jQuery("#css_files li").size()+1)+'.</td><td><input class="css_enabled" type="text" name="css_files['+f+"]["+e+'][include][]" value="" size="70" /></td><td><select class="css_file_template css_enabled"></select></td><td><input class="css_file_delete css_enabled button" type="button" value="Delete" /></td><td><input class="css_file_verify css_enabled button" type="button" value="Verify URI" /></td></tr></table></li>');b.find("input:text").val(d);var a=b.find(".css_file_template");for(var c in minify_templates[f]){a.append(jQuery("<option />").val(c).html(minify_templates[f][c]))}a.val(e);jQuery("#css_files").append(b).find("li:last input:first").focus();w3tc_minify_css_file_clear()}function w3tc_minify_js_theme(a){jQuery("#js_themes").val(a);jQuery("#js_files :text").each(function(){var b=jQuery(this);if(b.attr("name").indexOf("js_files["+a+"]")!=0){b.parents("li").hide()}else{b.parents("li").show()}});w3tc_minify_js_file_clear()}function w3tc_minify_css_theme(a){jQuery("#css_themes").val(a);jQuery("#css_files :text").each(function(){var b=jQuery(this);if(b.attr("name").indexOf("css_files["+a+"]")!=0){b.parents("li").hide()}else{b.parents("li").show()}});w3tc_minify_css_file_clear()}function w3tc_cdn_get_cnames(){var a=[];jQuery("#cdn_cnames input[type=text]").each(function(){var c=jQuery(this).val();if(c){var b=/^\*\.(.*)$/.exec(c);if(b){a=[];for(var d=1;d<=10;d++){a.push("cdn"+d+"."+b[1])}return false}a.push(c)}});return a}function w3tc_cdn_cnames_assign(){var a=jQuery("#cdn_cnames li"),b=a.size();if(b>1){a.eq(0).find(".cdn_cname_delete").show()}else{a.eq(0).find(".cdn_cname_delete").hide()}jQuery(a).each(function(d){var c="";if(b>1){switch(d){case 0:c="(reserved for CSS)";break;case 1:c="(reserved for JS in <head>)";break;case 2:c="(reserved for JS after <body>)";break;case 3:c="(reserved for JS before </body>)";break}}jQuery(this).find("span").text(c)})}function w3tc_cloudflare_api_request(f,e,d){var b=jQuery("#cloudflare_email");var c=jQuery("#cloudflare_key");var a=jQuery("#cloudflare_zone");if(!b.val()){alert("Please enter CloudFlare E-Mail.");b.focus();return false}if(!c.val()){alert("Please enter CloudFlare API key.");c.focus();return false}if(!a.val()){alert("Please enter CloudFlare zone.");a.focus();return false}jQuery.post("admin.php?page=w3tc_general",{w3tc_cloudflare_api_request:1,email:b.val(),key:c.val(),zone:a.val(),action:f,value:e,_wpnonce:d},function(g){alert(g.result?"OK":"Request failed. Error: "+g.error)},"json");return true}function w3tc_toggle(c,b){if(b===undefined){b=true}var d="#"+c,a="."+c;jQuery(a).click(function(){var e=b;jQuery(a).each(function(){var f=jQuery(this).is(":checked");if((b&&!f)||(!b&&f)){e=!b;return false}});if(e){jQuery(d).attr("checked","checked")}else{jQuery(d).removeAttr("checked")}});jQuery(d).click(function(){var e=jQuery(this).is(":checked");jQuery(a).each(function(){if(e){jQuery(this).attr("checked","checked")}else{jQuery(this).removeAttr("checked")}})})}function w3tc_beforeupload_bind(){jQuery(window).bind("beforeunload",w3tc_beforeunload)}function w3tc_beforeupload_unbind(){jQuery(window).unbind("beforeunload",w3tc_beforeunload)}function w3tc_beforeunload(){return"Are you sure you wish to navigate away from this page without saving your changes?"}jQuery(function(){w3tc_toggle("enabled");jQuery(".button-tweet").live("click",function(){window.open("http://twitter.com/?status="+encodeURIComponent("YES! I optimized my #wordpress site's #performance using the W3 Total Cache #plugin by @w3edge. Check it out! http://j.mp/A69xX"),"_blank")});jQuery(".button-rating").live("click",function(){window.open("http://wordpress.org/extend/plugins/w3-total-cache/","_blank")});w3tc_toggle("browsercache_expires");w3tc_toggle("browsercache_cache_control");w3tc_toggle("browsercache_etag");w3tc_toggle("browsercache_w3tc");w3tc_toggle("browsercache_compression");w3tc_toggle("browsercache_replace");w3tc_input_enable(".html_enabled",jQuery("#html_enabled:checked").size());w3tc_input_enable(".js_enabled",jQuery("#js_enabled:checked").size());w3tc_input_enable(".css_enabled",jQuery("#css_enabled:checked").size());w3tc_minify_js_theme(jQuery("#js_themes").val());w3tc_minify_css_theme(jQuery("#css_themes").val());jQuery("#html_enabled").click(function(){w3tc_input_enable(".html_enabled",this.checked)});jQuery("#js_enabled").click(function(){w3tc_input_enable(".js_enabled",jQuery(this).is(":checked"))});jQuery("#css_enabled").click(function(){w3tc_input_enable(".css_enabled",jQuery(this).is(":checked"))});jQuery(".js_file_verify,.css_file_verify").live("click",function(){var b=jQuery(this).parents("li").find(":text").val();if(b==""){alert("Empty URI")}else{var a="";if(/^https?:\/\//.test(b)){a=b}else{a="/"+b}w3tc_popup(a,"file_verify")}});jQuery(".js_file_template").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","js_files["+jQuery("#js_themes").val()+"]["+jQuery(this).val()+"]["+jQuery(this).parents("li").find(".js_file_location").val()+"][]")});jQuery(".css_file_template").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","css_files["+jQuery("#css_themes").val()+"]["+jQuery(this).val()+"][include][]")});jQuery(".js_file_location").live("change",function(){jQuery(this).parents("li").find(":text").attr("name","js_files["+jQuery("#js_themes").val()+"]["+jQuery(this).parents("li").find(".js_file_template").val()+"]["+jQuery(this).val()+"][]")});jQuery(".js_file_delete").live("click",function(){var a=jQuery(this).parents("li");if(a.find("input[type=text]").val()==""||confirm("Are you sure you want to remove this JS file?")){a.remove();w3tc_minify_js_file_clear();w3tc_beforeupload_bind()}return false});jQuery(".css_file_delete").live("click",function(){var a=jQuery(this).parents("li");if(a.find("input[type=text]").val()==""||confirm("Are you sure you want to remove this CSS file?")){a.remove();w3tc_minify_css_file_clear();w3tc_beforeupload_bind()}return false});jQuery("#js_file_add").click(function(){w3tc_minify_js_file_add(jQuery("#js_themes").val(),"default","include","")});jQuery("#css_file_add").click(function(){w3tc_minify_css_file_add(jQuery("#css_themes").val(),"default","")});jQuery("#js_themes").change(function(){w3tc_minify_js_theme(jQuery(this).val())});jQuery("#css_themes").change(function(){w3tc_minify_css_theme(jQuery(this).val())});jQuery("#minify_form").submit(function(){var g=[],b=[],c=[],e=[],f=false,d=[],a=[];jQuery("#js_files :text").each(function(){var j=jQuery(this).val(),p=jQuery(this).attr("name"),o=j+p,m="";var k=/js_files\[([a-z0-9_\/]+)\]/.exec(p);if(k){m="["+jQuery("#js_themes option[value="+k[1]+"]").text()+"] "+j}if(j!=""){for(var l=0;l<g.length;l++){if(g[l]==o){f=true;break}}g.push(o);var h=j.indexOf("?");if(h!=-1){if(!/^(https?:)?\/\//.test(j)){d.push(m)}j=j.substr(0,h)}else{if(!/\.js$/.test(j)){c.push(m)}}}});jQuery("#css_files :text").each(function(){var j=jQuery(this).val(),p=jQuery(this).attr("name"),o=j+p,m="";var k=/css_files\[([a-z0-9_\/]+)\]/.exec(p);if(k){m="["+jQuery("#css_themes option[value="+k[1]+"]").text()+"] "+j}if(j!=""){for(var l=0;l<b.length;l++){if(b[l]==o){f=true;break}}b.push(o);var h=j.indexOf("?");if(h!=-1){if(!/^(https?:)?\/\//.test(j)){a.push(m)}j=j.substr(0,h)}else{if(!/\.css$/.test(j)){e.push(m)}}}});if(jQuery("#js_enabled:checked").size()){if(c.length&&!confirm("The following files have invalid JS file extension:\r\n\r\n"+c.join("\r\n")+"\r\n\r\nAre you confident these files contain valid JS code?")){return false}if(d.length){alert("We recommend using the entire URI for files with query string (GET) variables. You entered:\r\n\r\n"+d.join("\r\n"));return false}}if(jQuery("#css_enabled:checked").size()){if(e.length&&!confirm("The following files have invalid CSS file extension:\r\n\r\n"+e.join("\r\n")+"\r\n\r\nAre you confident these files contain valid CSS code?")){return false}if(a.length){alert("We recommend using the entire URI for files with query string (GET) variables. You entered:\r\n\r\n"+a.join("\r\n"));return false}}if(f){alert("Duplicate files have been found in your minify settings, please check your settings and re-save.");return false}return true});jQuery(".w3tc-tab").click(function(){jQuery(".w3tc-tab-content").hide();jQuery(this.rel).show()});jQuery("#cdn_export_library").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_export_library&_wpnonce="+jQuery(this).metadata().nonce,"cdn_export_library")});jQuery("#cdn_import_library").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_import_library&_wpnonce="+jQuery(this).metadata().nonce,"cdn_import_library")});jQuery("#cdn_queue").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_queue&_wpnonce="+jQuery(this).metadata().nonce,"cdn_queue")});jQuery("#cdn_rename_domain").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_rename_domain&_wpnonce="+jQuery(this).metadata().nonce,"cdn_rename_domain")});jQuery("#cdn_purge").click(function(){w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_purge&_wpnonce="+jQuery(this).metadata().nonce,"cdn_purge")});jQuery(".cdn_export").click(function(){var a=jQuery(this).metadata();w3tc_popup("admin.php?page=w3tc_cdn&w3tc_cdn_export&cdn_export_type="+a.type+"&_wpnonce="+a.nonce,"cdn_export_"+a.type)});jQuery("#cdn_test").click(function(){var e=jQuery(this);var c=e.metadata();var g=w3tc_cdn_get_cnames();var f={w3tc_cdn_test:1,_wpnonce:c.nonce};switch(c.type){case"ftp":jQuery.extend(f,{engine:"ftp","config[host]":jQuery("#cdn_ftp_host").val(),"config[user]":jQuery("#cdn_ftp_user").val(),"config[path]":jQuery("#cdn_ftp_path").val(),"config[pass]":jQuery("#cdn_ftp_pass").val(),"config[pasv]":jQuery("#cdn_ftp_pasv:checked").size()});if(g.length){f["config[domain][]"]=g}break;case"s3":jQuery.extend(f,{engine:"s3","config[key]":jQuery("#cdn_s3_key").val(),"config[secret]":jQuery("#cdn_s3_secret").val(),"config[bucket]":jQuery("#cdn_s3_bucket").val()});if(g.length){f["config[cname][]"]=g}break;case"cf":jQuery.extend(f,{engine:"cf","config[key]":jQuery("#cdn_cf_key").val(),"config[secret]":jQuery("#cdn_cf_secret").val(),"config[bucket]":jQuery("#cdn_cf_bucket").val(),"config[id]":jQuery("#cdn_cf_id").val()});if(g.length){f["config[cname][]"]=g}break;case"cf2":jQuery.extend(f,{engine:"cf2","config[key]":jQuery("#cdn_cf2_key").val(),"config[secret]":jQuery("#cdn_cf2_secret").val(),"config[origin]":jQuery("#cdn_cf2_origin").val(),"config[id]":jQuery("#cdn_cf2_id").val()});if(g.length){f["config[cname][]"]=g}break;case"rscf":jQuery.extend(f,{engine:"rscf","config[user]":jQuery("#cdn_rscf_user").val(),"config[key]":jQuery("#cdn_rscf_key").val(),"config[location]":jQuery("#cdn_rscf_location").val(),"config[container]":jQuery("#cdn_rscf_container").val(),"config[id]":jQuery("#cdn_rscf_id").val()});if(g.length){f["config[cname][]"]=g}break;case"azure":jQuery.extend(f,{engine:"azure","config[user]":jQuery("#cdn_azure_user").val(),"config[key]":jQuery("#cdn_azure_key").val(),"config[container]":jQuery("#cdn_azure_container").val()});if(g.length){f["config[cname][]"]=g}break;case"mirror":jQuery.extend(f,{engine:"mirror"});if(g.length){f["config[domain][]"]=g}break;case"netdna":jQuery.extend(f,{engine:"netdna","config[apiid]":jQuery("#cdn_netdna_apiid").val(),"config[apikey]":jQuery("#cdn_netdna_apikey").val()});if(g.length){f["config[domain][]"]=g}break;case"cotendo":var b=[],d=jQuery("#cdn_cotendo_zones").val();if(d){b=d.split(/[\r\n,;]+/)}jQuery.extend(f,{engine:"cotendo","config[username]":jQuery("#cdn_cotendo_username").val(),"config[password]":jQuery("#cdn_cotendo_password").val()});if(b.length){f["config[zones][]"]=b}if(g.length){f["config[domain][]"]=g}break;case"edgecast":jQuery.extend(f,{engine:"edgecast","config[account]":jQuery("#cdn_edgecast_account").val(),"config[token]":jQuery("#cdn_edgecast_token").val()});if(g.length){f["config[domain][]"]=g}break}var a=jQuery("#cdn_test_status");a.removeClass("w3tc-error");a.removeClass("w3tc-success");a.addClass("w3tc-process");a.html("Testing...");jQuery.post("admin.php?page=w3tc_general",f,function(h){a.addClass(h.result?"w3tc-success":"w3tc-error");a.html(h.error)},"json")});jQuery("#cdn_create_container").live("click",function(){var c=jQuery(this);var b=c.metadata();var f=w3tc_cdn_get_cnames();var d=null;var e={w3tc_cdn_create_container:1,_wpnonce:b.nonce};switch(b.type){case"s3":jQuery.extend(e,{engine:"s3","config[key]":jQuery("#cdn_s3_key").val(),"config[secret]":jQuery("#cdn_s3_secret").val(),"config[bucket]":jQuery("#cdn_s3_bucket").val(),"config[bucket_location]":jQuery("#cdn_s3_bucket_location").val()});if(f.length){e["config[cname][]"]=f}break;case"cf":d=jQuery("#cdn_cf_id");jQuery.extend(e,{engine:"cf","config[key]":jQuery("#cdn_cf_key").val(),"config[secret]":jQuery("#cdn_cf_secret").val(),"config[bucket]":jQuery("#cdn_cf_bucket").val(),"config[bucket_location]":jQuery("#cdn_cf_bucket_location").val()});if(f.length){e["config[cname][]"]=f}break;case"cf2":d=jQuery("#cdn_cf2_id");jQuery.extend(e,{engine:"cf2","config[key]":jQuery("#cdn_cf2_key").val(),"config[secret]":jQuery("#cdn_cf2_secret").val(),"config[origin]":jQuery("#cdn_cf2_origin").val(),"config[bucket_location]":jQuery("#cdn_cf2_bucket_location").val()});if(f.length){e["config[cname][]"]=f}break;case"rscf":d=jQuery("#cdn_cnames input[type=text]:first");jQuery.extend(e,{engine:"rscf","config[user]":jQuery("#cdn_rscf_user").val(),"config[key]":jQuery("#cdn_rscf_key").val(),"config[location]":jQuery("#cdn_rscf_location").val(),"config[container]":jQuery("#cdn_rscf_container").val()});if(f.length){e["config[cname][]"]=f}break;case"azure":jQuery.extend(e,{engine:"azure","config[user]":jQuery("#cdn_azure_user").val(),"config[key]":jQuery("#cdn_azure_key").val(),"config[container]":jQuery("#cdn_azure_container").val()});if(f.length){e["config[cname][]"]=f}break}var a=jQuery("#cdn_create_container_status");a.removeClass("w3tc-error");a.removeClass("w3tc-success");a.addClass("w3tc-process");a.html("Creating...");jQuery.post("admin.php?page=w3tc_general",e,function(g){a.addClass(g.result?"w3tc-success":"w3tc-error");a.html(g.error);if(d&&d.size()&&g.container_id){d.val(g.container_id)}},"json")});jQuery("#cloudflare_purge_cache").click(function(){if(confirm("Purging your site's cache will remove all cache files. It may take up to 48 hours for the cache to completely rebuild on CloudFlare's global network. Are you sure you want to purge the cache?")){var a=jQuery(this).metadata().nonce;w3tc_cloudflare_api_request("fpurge_ts",1,a)}});jQuery("#memcached_test").click(function(){var a=jQuery("#memcached_test_status");a.removeClass("w3tc-error");a.removeClass("w3tc-success");a.addClass("w3tc-process");a.html("Testing...");jQuery.post("admin.php?page=w3tc_general",{w3tc_test_memcached:1,servers:jQuery("#memcached_servers").val(),_wpnonce:jQuery(this).metadata().nonce},function(b){a.addClass(b.result?"w3tc-success":"w3tc-error");a.html(b.error)},"json")});jQuery(".minifier_test").click(function(){var c=jQuery(this);var b=c.metadata();var d={w3tc_test_minifier:1,_wpnonce:b.nonce};switch(b.type){case"yuijs":jQuery.extend(d,{engine:"yuijs",path_java:jQuery("#minify_yuijs_path_java").val(),path_jar:jQuery("#minify_yuijs_path_jar").val()});break;case"yuicss":jQuery.extend(d,{engine:"yuicss",path_java:jQuery("#minify_yuicss_path_java").val(),path_jar:jQuery("#minify_yuicss_path_jar").val()});break;case"ccjs":jQuery.extend(d,{engine:"ccjs",path_java:jQuery("#minify_ccjs_path_java").val(),path_jar:jQuery("#minify_ccjs_path_jar").val()});break}var a=c.next();a.removeClass("w3tc-error");a.removeClass("w3tc-success");a.addClass("w3tc-process");a.html("Testing...");jQuery.post("admin.php?page=w3tc_general",d,function(e){a.addClass(e.result?"w3tc-success":"w3tc-error");a.html(e.error)},"json")});jQuery("#cdn_cname_add").click(function(){jQuery("#cdn_cnames").append('<li><input type="text" name="cdn_cnames[]" value="" size="60" /> <input class="button cdn_cname_delete" type="button" value="Delete" /> <span></span></li>');w3tc_cdn_cnames_assign()});jQuery(".cdn_cname_delete").live("click",function(){var a=jQuery(this).parent();if(a.find("input[type=text]").val()==""||confirm("Are you sure you want to remove this CNAME?")){a.remove();w3tc_cdn_cnames_assign();w3tc_beforeupload_bind()}});jQuery("#cdn_form").submit(function(){var b=[],a=true;jQuery("#cdn_cnames input[type=text]").each(function(){var c=jQuery(this).val();if(c){if(jQuery.inArray(c,b)!=-1){alert('CNAME "'+c+'" already exists.');a=false;return false}else{b.push(c)}}});return a});jQuery("#support_more_files").live("click",function(){jQuery(this).before('<input type="file" name="files[]" /><br />');return false});jQuery("#support_form").live("submit",function(){var a=jQuery(".required #support_url");var b=jQuery(".required #support_name");var e=jQuery(".required #support_email");var d=jQuery(".required #support_phone");var f=jQuery(".required #support_subject");var j=jQuery(".required #support_description");var c=jQuery(".required #support_wp_login");var h=jQuery(".required #support_wp_password");var g=jQuery(".required #support_ftp_host");var i=jQuery(".required #support_ftp_login");var k=jQuery(".required #support_ftp_password");if(a.size()&&a.val()==""){alert("Please enter the address of your site in the Site URL field.");a.focus();return false}if(b.size()&&b.val()==""){alert("Please enter your name in the Name field.");b.focus();return false}if(e.size()&&!/^[a-z0-9_\-\.]+@[a-z0-9-\.]+\.[a-z]{2,5}$/.test(e.val().toLowerCase())){alert("Please enter valid email address in the E-Mail field.");e.focus();return false}if(d.size()&&!/^[0-9\-\. \(\)\+]+$/.test(d.val())){alert("Please enter your phone in the phone field.");d.focus();return false}if(f.size()&&f.val()==""){alert("Please enter subject in the subject field.");f.focus();return false}if(j.size()&&j.val()==""){alert("Please describe the issue in the issue description field.");j.focus();return false}if(c.size()&&c.val()==""){alert("Please enter an administrator login. Remember you can create a temporary one just for this support case.");c.focus();return false}if(h.size()&&h.val()==""){alert("Please enter WP Admin password, be sure it's spelled correctly.");h.focus();return false}if(g.size()&&g.val()==""){alert("Please enter SSH or FTP host for your site.");g.focus();return false}if(i.size()&&i.val()==""){alert("Please enter SSH or FTP login for your server. Remember you can create a temporary one just for this support case.");i.focus();return false}if(k.size()&&k.val()==""){alert("Please enter SSH or FTP password for your FTP account.");k.focus();return false}return true});jQuery("#support_request_type").live("change",function(){var a=jQuery(this);if(a.val()==""){alert("Please select request type.");a.focus();return false}var b=a.val(),c="";switch(b){case"bug_report":case"new_feature":c="support_form";break;case"email_support":case"phone_support":case"plugin_config":case"theme_config":case"linux_config":c="support_payment";break}if(c){jQuery("#support_container").html('<div id="support_loading">Loading...</div>').load("admin.php?page=w3tc_support&w3tc_"+c+"&request_type="+b+"&_wpnonce="+a.metadata().nonce);return false}return true});jQuery("#support_cancel").live("click",function(){jQuery("#support_container").html('<div id="support_loading">Loading...</div>').load("admin.php?page=w3tc_support&w3tc_support_select&_wpnonce="+jQuery(this).metadata().nonce)});jQuery("#mobile_form").submit(function(){var a=false;jQuery("#mobile_groups li").each(function(){if(jQuery(this).find(":checked").size()){var d=jQuery(this).find(".mobile_group").text();var c=jQuery(this).find(":selected").val();var e=jQuery(this).find("input[type=text]").val();var b=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");jQuery("#mobile_groups li").each(function(){if(jQuery(this).find(":checked").size()){var i=jQuery(this).find(".mobile_group").text();if(i!=d){var h=jQuery(this).find(":selected").val();var g=jQuery(this).find("input[type=text]").val();var f=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(g==""&&e==""&&h!=""&&h==c){alert('Duplicate theme "'+h+'" found in the group "'+d+'".');a=true;return false}if(g!=""&&g==e){alert('Duplicate redirect "'+g+'" found in the group "'+d+'".');a=true;return false}jQuery.each(f,function(j,k){if(jQuery.inArray(k,b)!=-1){alert('Duplicate stem "'+k+'" found in the group "'+i+'".');a=true;return false}})}}});if(a){return false}}});if(a){return false}});jQuery("#mobile_add").click(function(){var d=prompt('Enter group name (only "0-9", "a-z", "_" symbols are allowed).');if(d!==null){d=d.toLowerCase();d=d.replace(/[^0-9a-z_]+/g,"_");d=d.replace(/^_+/,"");d=d.replace(/_+$/,"");if(d){var c=false;jQuery(".mobile_group").each(function(){if(jQuery(this).html()==d){alert("Group already exists!");c=true;return false}});if(!c){var b=jQuery('<li id="mobile_group_'+d+'"><table class="form-table"><tr><th>Group name:</th><td><span class="mobile_group_number">'+(jQuery("#mobile_groups li").size()+1)+'.</span> <span class="mobile_group">'+d+'</span> <input type="button" class="button mobile_delete" value="Delete group" /></td></tr><tr><th><label for="mobile_groups_'+d+'_enabled">Enabled:</label></th><td><input type="hidden" name="mobile_groups['+d+'][enabled]" value="0" /><input id="mobile_groups_'+d+'_enabled" type="checkbox" name="mobile_groups['+d+'][enabled]" value="1" checked="checked" /></td></tr><tr><th><label for="mobile_groups_'+d+'_theme">Theme:</label></th><td><select id="mobile_groups_'+d+'_theme" name="mobile_groups['+d+'][theme]"><option value="">-- Pass-through --</option></select><br /><span class="description">Assign this group of user agents to a specific them. Leaving this option "Active Theme" allows any plugins you have (e.g. mobile plugins) to properly handle requests for these user agents. If the "redirect users to" field is not empty, this setting is ignored.</span></td></tr><tr><th><label for="mobile_groups_'+d+'_redirect">Redirect users to:</label></th><td><input id="mobile_groups_'+d+'_redirect" type="text" name="mobile_groups['+d+'][redirect]" value="" size="60" /><br /><span class="description">A 302 redirect is used to send this group of users to another hostname (domain); recommended if a 3rd party service provides a mobile version of your site.</span></td></tr><tr><th><label for="mobile_groups_'+d+'_agents">User agents:</label></th><td><textarea id="mobile_groups_'+d+'_agents" name="mobile_groups['+d+'][agents]" rows="10" cols="50"></textarea><br /><span class="description">Specify the user agents for this group.</span></td></tr></table></li>');var a=b.find("select");jQuery.each(mobile_themes,function(e,f){a.append(jQuery("<option />").val(e).html(f))});jQuery("#mobile_groups").append(b);w3tc_mobile_groups_clear();window.location.hash="#mobile_group_"+d;b.find("textarea").focus()}}else{alert("Empty group name!")}}});jQuery(".mobile_delete").live("click",function(){if(confirm("Are you sure want to delete this group?")){jQuery(this).parents("#mobile_groups li").remove();w3tc_mobile_groups_clear();w3tc_beforeupload_bind()}});w3tc_mobile_groups_clear();jQuery("#referrer_form").submit(function(){var a=false;jQuery("#referrer_groups li").each(function(){if(jQuery(this).find(":checked").size()){var d=jQuery(this).find(".referrer_group").text();var c=jQuery(this).find(":selected").val();var e=jQuery(this).find("input[type=text]").val();var b=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");jQuery("#referrer_groups li").each(function(){if(jQuery(this).find(":checked").size()){var i=jQuery(this).find(".referrer_group").text();if(i!=d){var h=jQuery(this).find(":selected").val();var g=jQuery(this).find("input[type=text]").val();var f=jQuery.trim(jQuery(this).find("textarea").val()).split("\n");if(g==""&&e==""&&h!=""&&h==c){alert('Duplicate theme "'+h+'" found in the group "'+d+'".');a=true;return false}if(g!=""&&g==e){alert('Duplicate redirect "'+g+'" found in the group "'+d+'".');a=true;return false}jQuery.each(f,function(j,k){if(jQuery.inArray(k,b)!=-1){alert('Duplicate stem "'+k+'" found in the group "'+i+'".');a=true;return false}})}}});if(a){return false}}});if(a){return false}});jQuery("#referrer_add").click(function(){var d=prompt('Enter group name (only "0-9", "a-z", "_" symbols are allowed).');if(d!==null){d=d.toLowerCase();d=d.replace(/[^0-9a-z_]+/g,"_");d=d.replace(/^_+/,"");d=d.replace(/_+$/,"");if(d){var c=false;jQuery(".referrer_group").each(function(){if(jQuery(this).html()==d){alert("Group already exists!");c=true;return false}});if(!c){var b=jQuery('<li id="referrer_group_'+d+'"><table class="form-table"><tr><th>Group name:</th><td><span class="referrer_group_number">'+(jQuery("#referrer_groups li").size()+1)+'.</span> <span class="referrer_group">'+d+'</span> <input type="button" class="button referrer_delete" value="Delete group" /></td></tr><tr><th><label for="referrer_groups_'+d+'_enabled">Enabled:</label></th><td><input type="hidden" name="referrer_groups['+d+'][enabled]" value="0" /><input id="referrer_groups_'+d+'_enabled" type="checkbox" name="referrer_groups['+d+'][enabled]" value="1" checked="checked" /></td></tr><tr><th><label for="referrer_groups_'+d+'_theme">Theme:</label></th><td><select id="referrer_groups_'+d+'_theme" name="referrer_groups['+d+'][theme]"><option value="">-- Pass-through --</option></select><br /><span class="description">Assign this group of referrers to a specific them. Leaving this option "Active Theme" allows any plugins you have (e.g. referrer plugins) to properly handle requests for these referrers. If the "redirect users to" field is not empty, this setting is ignored.</span></td></tr><tr><th><label for="referrer_groups_'+d+'_redirect">Redirect users to:</label></th><td><input id="referrer_groups_'+d+'_redirect" type="text" name="referrer_groups['+d+'][redirect]" value="" size="60" /><br /><span class="description">A 302 redirect is used to send this group of users to another hostname (domain); recommended if a 3rd party service provides a referrer version of your site.</span></td></tr><tr><th><label for="referrer_groups_'+d+'_referrers">Referrers:</label></th><td><textarea id="referrer_groups_'+d+'_referrers" name="referrer_groups['+d+'][referrers]" rows="10" cols="50"></textarea><br /><span class="description">Specify the referrers for this group.</span></td></tr></table></li>');var a=b.find("select");jQuery.each(referrer_themes,function(e,f){a.append(jQuery("<option />").val(e).html(f))});jQuery("#referrer_groups").append(b);w3tc_referrer_groups_clear();window.location.hash="#referrer_group_"+d;b.find("textarea").focus()}}else{alert("Empty group name!")}}});jQuery(".referrer_delete").live("click",function(){if(confirm("Are you sure want to delete this group?")){jQuery(this).parents("#referrer_groups li").remove();w3tc_referrer_groups_clear();w3tc_beforeupload_bind()}});w3tc_referrer_groups_clear();if(jQuery.ui&&jQuery.ui.sortable){jQuery("#js_files,#css_files").sortable({axis:"y",stop:function(){jQuery(this).find("li").each(function(a){jQuery(this).find("td:eq(0)").html((a+1)+".")})}});jQuery("#cdn_cnames").sortable({axis:"y",stop:w3tc_cdn_cnames_assign});jQuery("#mobile_groups").sortable({axis:"y",stop:function(){jQuery("#mobile_groups .mobile_group_number").each(function(a){jQuery(this).html((a+1)+".")})}});jQuery("#referrer_groups").sortable({axis:"y",stop:function(){jQuery("#referrer_groups .referrer_group_number").each(function(a){jQuery(this).html((a+1)+".")})}})}jQuery(".w3tc-show-rules").click(function(){var a=jQuery(this),b=a.parent().find(".w3tc-rules");if(b.is(":visible")){b.css("display","none");a.val("view code")}else{b.css("display","block");a.val("hide code")}});jQuery("#w3tc input,#w3tc select,#w3tc textarea").live("change",function(){var a=false;jQuery(this).parents().andSelf().each(function(){if(jQuery(this).hasClass("w3tc-ignore-change")||jQuery(this).hasClass("lightbox")){a=true;return false}});if(!a){w3tc_beforeupload_bind()}});jQuery(".w3tc-button-save").click(w3tc_beforeupload_unbind)});